<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>太平洋戦争の地図</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.8.0/mapbox-gl.js"></script>
<style>
    body {
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        height: 100vh;
    }
    #map {
        flex: 1;
        width: 100%;
    }
    #details {
        width: 25%;
        height: 100vh;
        position: absolute;
        right: 0;
        top: 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
        display: none;
    }
    #details h3 {
        margin-top: 0;
    }
    #details .close-btn {
        cursor: pointer;
        background: gray;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        margin-bottom: 10px;
    }
    #timeline {
        height: 70px;
        background: #f8f9fa;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-top: 1px solid #ddd;
    }
    #slider {
        width: 80%;
    }
    #slider-labels {
        display: flex;
        justify-content: space-between;
        width: 80%;
        font-size: 12px;
        margin-top: 5px;
    }
    #details img {
        width: 80%; /* 画像を親要素の80%の幅に設定 */
        margin: 10px auto; /* 中央揃え */
        display: block; /* ブロック要素にすることで中央寄せ */
        border-radius: 5px; /* 角を丸くする */
    }

    body {
    background-color: #2C2C2C; /* 背景色を暗めに */
    color: #D3D3D3; /* 文字色をライトグレーに */
}
#details {
    background-color: rgba(44, 44, 44, 0.9); /* 背景を暗く半透明に */
    border-left: 4px solid #8B0000; /* 赤いアクセントを追加 */
}
#timeline {
    background-color: #1B1B3A; /* タイムラインを暗い色に */
    border-top: 2px solid #8B0000; /* 赤のアクセントライン */
}
button.close-btn {
    background-color: #8B0000; /* 閉じるボタンを赤に */
    color: #FFFFFF;
}


</style>
</head>
<body>
<div id="map"></div>
<div id="timeline">
    <input type="range" id="slider" min="0" max="8" value="0">
    <div id="slider-labels"></div>
</div>
<div id="details">
    <button class="close-btn">閉じる</button>
    <h3>事件の詳細</h3>
    <p>スライダーを動かして事件を選択してください。</p>
</div>

<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiZ2dwbGF5ZXIiLCJhIjoiY200OXBzcmI1MGR6bzJxcTFrdDJ1MGJyNSJ9.o_VpEScSsAPdt8U8PDB58Q';
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        projection: 'globe',
        zoom: 2,
        center: [130, 35] // 初期表示地点
    });

    map.addControl(new mapboxgl.NavigationControl());
    map.on('style.load', () => {
        map.setFog({});
    });

    const events = [
        { year: "1941", title: "真珠湾攻撃", coordinates: [-157.97901871661816, 21.358433611011023], 
          description: "1941年12月7日、日本軍がアメリカの真珠湾を奇襲。太平洋戦争の開始となる。", 
          context: "日本は石油禁輸措置を受け、アメリカとの交渉が決裂。この攻撃によりアメリカは戦争に参加。" ,
          imageUrl: "https://www.jiji.com/news/handmade/special/feature/v2/photos/20110803end_of_pacifi_war/02188958.jpg"
        },
        { year: "1942", title: "シンガポール陥落", coordinates: [103.8198, 1.3521], 
          description: "1942年2月15日、日本がシンガポールを占領。", 
          context: "イギリス植民地の重要拠点が陥落し、日本の支配が広がった。" ,
          imageUrl: "https://japanda.info/wp-content/uploads/2019/02/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88-2019-02-16-20.09.04.png"
        },
        { year: "1942", title: "ミッドウェー海戦", coordinates: [-177.365, 28.2], 
          description: "1942年6月4日～6月7日、アメリカと日本の間で行われた重要な海戦。", 
          context: "この戦いは太平洋戦争の転換点となった。",
          imageUrl:"https://p.potaufeu.asahi.com/98d5-p/picture/26880274/54032eb57953385c2a3de1a470bc12f7_640px.jpg"
        },
        { year: "1942-1943", title: "ガダルカナルの戦い", coordinates: [160.2, -9.433], 
          description: "1942年8月7日～1943年2月9日、ソロモン諸島での戦い。", 
          context: "アメリカ軍が勝利し、日本は戦略的後退を余儀なくされた。" ,
          imageUrl:"https://business.nikkei.com/atcl/gen/19/00179/042600114/fb.jpg"
        },
        { year: "1945", title: "硫黄島の戦い", coordinates: [141.2909, 24.7542], 
          description: "1945年2月19日～3月26日、硫黄島での激戦。", 
          context: "アメリカ軍の上陸作戦により激戦地となった。",
          imageUrl:"https://www.jiji.com/news/handmade/topic/d4_mili/bij412-NH104130.jpg"
        },
        { year: "1945", title: "沖縄戦", coordinates: [127.669, 26.501], 
          description: "1945年4月1日～6月22日、沖縄本島での地上戦。", 
          context: "日本本土を巡る最後の防衛戦。",
          imageUrl:"https://news.1242.com/wp-content/uploads/2022/06/2019122403209TR.jpg"
        },
        { year: "1945", title: "広島原爆投下", coordinates: [132.455, 34.385], 
          description: "1945年8月6日、広島に原子爆弾が投下された。", 
          context: "原子爆弾により戦争の終結が近づいた。" ,
          imageUrl:"https://courrier.jp/media/2020/08/19224636/GettyImages-566461861-scaled-e1597979712670-1600x900.jpg"
        },
        { year: "1945", title: "長崎原爆投下", coordinates: [129.872, 32.765], 
          description: "1945年8月9日、長崎に原子爆弾が投下された。", 
          context: "広島に続き2回目の原子爆弾使用。" ,
          imageUrl:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSaQXoybCJj8IgLMqZSMXjkBRXJ1T3grBVRyA&s"
        },
        { year: "1945", title: "終戦", coordinates: [139.6917, 35.6895], 
          description: "1945年8月15日、日本が降伏を表明。太平洋戦争が終結。", 
          context: "ポツダム宣言を受諾し降伏。" ,
          imageUrl:"https://president.ismcdn.jp/mwimgs/b/8/n/img_b8ad1488ac54e9a869fdd0b3d140535e1004668.jpg"
        }
    ];

    const detailsContainer = document.getElementById('details');
    const slider = document.getElementById('slider');
    const sliderLabels = document.getElementById('slider-labels');

    // スライダーに年代ラベルを追加
    sliderLabels.innerHTML = events.map(e => `<span>${e.year}</span>`).join("");

    

    // スクリプト冒頭で変数を初期化
let currentMarker = null;

// スライダーのイベント処理
slider.addEventListener('input', () => {
    const index = parseInt(slider.value);
    const event = events[index];

    map.flyTo({
    center: [event.coordinates[0], event.coordinates[1]], // 中心
    zoom: 10,
    offset: [-window.innerWidth * 0.13, 0] // 横に25%ずらす（右側の詳細タブ分）
});
    
    // 既存のマーカーを削除
    if (currentMarker) {
        currentMarker.remove();
    }

    // 新しいマーカーを作成して追加
    currentMarker = new mapboxgl.Marker({ color: 'red' }) // 赤いマーカーを作成
        .setLngLat(event.coordinates) // 座標を設定
        .addTo(map);

    // 詳細を表示
    detailsContainer.style.display = 'block';
    detailsContainer.innerHTML = `
        <button class="close-btn">閉じる</button>
        <img src="${event.imageUrl}" alt="${event.title}">
        <h3>${event.title}</h3>
        <p>${event.description}</p>
        <p><strong>時代背景:</strong> ${event.context}</p>
    `;

    // 閉じるボタン処理
    detailsContainer.querySelector('.close-btn').addEventListener('click', () => {
        detailsContainer.style.display = 'none';
    });
});

    slider.dispatchEvent(new Event('input'));
    
</script>
</body>
</html>
